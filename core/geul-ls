#!/usr/bin/env bash
# geul-ls -- retreive list of articles in archive
# Author: Jaeho Shin <netj@sparcs.org>
# Created: 2009-03-15
set -e

GEUL_DIR=${GEUL_DIR:-`geuldir`}
export GEUL_DIR

Prefix=`geul-path-parse`

if [ $# -gt 0 ]; then
    qs=()
    for arg
    do qs+=(${qs:+-o} -ipath "$Prefix$arg.*,v")
    done
else
    qs=(-name "*,v")
fi

cd "$GEUL_DIR/archive"
find "$Prefix"* -type f \( "${qs[@]}" \) |
sed -E 's/,v$//; s/\.(txt|xhtml|html)$//'
